<Window x:Class="EDCBMonitor.SettingsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:EDCBMonitor"
        Title="設定" Height="650" Width="600"
        WindowStyle="None" ResizeMode="NoResize" AllowsTransparency="True"
        Background="Transparent" WindowStartupLocation="CenterOwner"
        FontFamily="Yu Gothic UI" FontSize="12"
        MouseLeftButtonDown="Window_MouseLeftButtonDown">

    <Window.Resources>
        <Style TargetType="{x:Type ScrollBar}">
            <Setter Property="Stylus.IsFlicksEnabled" Value="false" />
            <Setter Property="Foreground" Value="#666666" />
            <Setter Property="Background" Value="Transparent" />
            <Setter Property="Width" Value="6" />
            <Setter Property="Height" Value="Auto" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type ScrollBar}">
                        <Grid x:Name="GridRoot" Width="6" Background="{TemplateBinding Background}">
                            <Track x:Name="PART_Track" IsDirectionReversed="true" Focusable="false">
                                <Track.Thumb>
                                    <Thumb x:Name="Thumb">
                                        <Thumb.Template>
                                            <ControlTemplate TargetType="{x:Type Thumb}">
                                                <Border Background="{TemplateBinding Foreground}" CornerRadius="3"/>
                                            </ControlTemplate>
                                        </Thumb.Template>
                                    </Thumb>
                                </Track.Thumb>
                            </Track>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="Orientation" Value="Horizontal">
                                <Setter TargetName="GridRoot" Property="Width" Value="Auto" />
                                <Setter TargetName="GridRoot" Property="Height" Value="6" />
                                <Setter TargetName="PART_Track" Property="IsDirectionReversed" Value="False" />
                            </Trigger>
                            <Trigger Property="IsMouseOver" Value="true">
                                <Setter Property="Foreground" Value="#999999" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>
    
    <Border Background="#252526" BorderBrush="#88CCFF" BorderThickness="1" CornerRadius="4">
        <Grid Margin="20">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <TextBlock Text="設定" Foreground="White" FontSize="18" Margin="0,0,0,15"/>

            <TabControl Grid.Row="1" Background="Transparent" BorderThickness="0" Margin="0,0,0,10">
                <TabControl.Resources>
                    <Style TargetType="TabItem">
                        <Setter Property="Template">
                            <Setter.Value>
                                <ControlTemplate TargetType="TabItem">
                                    <Border Name="Border" BorderThickness="0,0,0,2" BorderBrush="Transparent" Margin="0,0,15,0" Padding="15,5">
                                        <ContentPresenter x:Name="ContentSite" VerticalAlignment="Center" HorizontalAlignment="Center" ContentSource="Header"/>
                                    </Border>
                                    <ControlTemplate.Triggers>
                                        <Trigger Property="IsSelected" Value="True">
                                            <Setter TargetName="Border" Property="BorderBrush" Value="#88CCFF" />
                                            <Setter Property="Foreground" Value="#88CCFF" />
                                        </Trigger>
                                        <Trigger Property="IsSelected" Value="False">
                                            <Setter Property="Foreground" Value="#999" />
                                        </Trigger>
                                        <Trigger Property="IsMouseOver" Value="True">
                                            <Setter Property="Foreground" Value="White" />
                                        </Trigger>
                                    </ControlTemplate.Triggers>
                                </ControlTemplate>
                            </Setter.Value>
                        </Setter>
                    </Style>
                </TabControl.Resources>

                <TabItem Header="基本設定">
                    <ScrollViewer VerticalScrollBarVisibility="Auto">
                        <StackPanel Margin="0,10,10,0">
                            <TextBlock Text="ファイルの場所" Foreground="#88CCFF" Margin="0,0,0,4"/>
                            <Border Background="#333337" CornerRadius="3" Padding="15,8" Margin="0,0,0,12">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column="0" Text="Reserve.txt のパス" Foreground="#BBB" FontSize="12" VerticalAlignment="Center" Margin="0,0,10,0"/>
                                    <TextBox Grid.Column="1" Name="TxtPath" Background="#1E1E1E" Foreground="White" BorderBrush="#555" Height="24" VerticalContentAlignment="Center" Padding="4,0" TextChanged="Interact_Changed"/>
                                    <Button Grid.Column="2" Name="BtnBrowse" Content="..." Width="30" Height="24" Margin="8,0,0,0" Background="#444" Foreground="White" BorderThickness="0" Click="BtnBrowse_Click"/>
                                </Grid>
                            </Border>

                            <TextBlock Text="ウィンドウ動作" Foreground="#88CCFF" Margin="0,0,0,4"/>
                            <Border Background="#333337" CornerRadius="3" Padding="15,8" Margin="0,0,0,12">
                                <StackPanel>
                                    <CheckBox Name="ChkTopmost" Content="常に最前面に表示する" Foreground="White" Margin="0,2" Click="Interact_Changed"/>
                                    <Grid Margin="0,8,0,0">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="30"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Grid.Column="0" Text="不透明度" Foreground="#BBB" VerticalAlignment="Center" Margin="0,0,15,0"/>
                                        <Slider Grid.Column="1" Name="SldOpacity" Minimum="0" Maximum="1.0" TickFrequency="0.05" IsSnapToTickEnabled="True" VerticalAlignment="Center" ValueChanged="SldOpacity_ValueChanged"/>
                                        <TextBlock Grid.Column="2" Text="{Binding ElementName=SldOpacity, Path=Value, StringFormat=N2}" Foreground="#BBB" HorizontalAlignment="Right" VerticalAlignment="Center"/>
                                    </Grid>
                                </StackPanel>
                            </Border>
                            
                            <TextBlock Text="テーマ" Foreground="#88CCFF" Margin="0,0,0,4"/>
                            <Border Background="#333337" CornerRadius="3" Padding="15,8" Margin="0,0,0,12">
                                <StackPanel Orientation="Horizontal">
                                    <Button Name="BtnThemeDark" Content="ダーク" Width="80" Height="24" Background="#1E1E1E" Foreground="White" BorderBrush="#555" BorderThickness="1" Click="BtnThemeDark_Click" Margin="0,0,10,0"/>
                                    <Button Name="BtnThemeLight" Content="ライト" Width="80" Height="24" Background="#F1F1F1" Foreground="Black" BorderThickness="0" Click="BtnThemeLight_Click"/>
                                </StackPanel>
                            </Border>

                            <TextBlock Text="番組名整形" Foreground="#88CCFF" Margin="0,0,0,4"/>
                            <Border Background="#333337" CornerRadius="3" Padding="15,8" Margin="0,0,0,12">
                                <StackPanel>
                                    <CheckBox Name="ChkEnableTitleRemove" Content="正規表現による文字削除を有効にする" Foreground="White" Margin="0,0,0,4" Click="DataSetting_Changed"/>
                                    <TextBox Name="TxtTitleRemovePattern" Background="#1E1E1E" Foreground="White" BorderBrush="#555" Height="24" VerticalContentAlignment="Center" TextChanged="DataSetting_Changed"/>
                                    <CheckBox Name="ChkHideDisabled" Content="無効な予約を表示しない" Foreground="White" Margin="0,10,0,0" Click="DataSetting_Changed"/>
                                    <CheckBox Name="ChkRecBold" Content="録画中の行を太字にする" Foreground="White" Margin="0,6,0,0" Click="Interact_Changed"/>
                                </StackPanel>
                            </Border>

                            <TextBlock Text="ツールチップ設定" Foreground="#88CCFF" Margin="0,0,0,4"/>
                        <Border Background="#333337" CornerRadius="3" Padding="15,8">
                            <StackPanel Orientation="Horizontal">
                                <CheckBox Name="ChkShowToolTip" Content="詳細情報のツールチップを表示する" Foreground="White" VerticalAlignment="Center" Margin="0,0,20,0" Click="Interact_Changed"/>
                                <TextBlock Text="ツールチップの幅" Foreground="#BBB" VerticalAlignment="Center" Margin="0,0,5,0"/>
                                <TextBox Name="TxtToolTipWidth" Width="50" Background="#1E1E1E" Foreground="White" BorderBrush="#555" Height="22" VerticalContentAlignment="Center" TextChanged="Interact_Changed"/>
                            </StackPanel>
                        </Border>
                        </StackPanel>
                        </ScrollViewer>
                </TabItem>

                <TabItem Header="表示・配色">
                    <ScrollViewer VerticalScrollBarVisibility="Auto">
                        <StackPanel Margin="0,10,10,0">
                            <TextBlock Text="フォント・レイアウト設定" Foreground="#88CCFF" Margin="0,0,0,4"/>
                            <Border Background="#333337" CornerRadius="3" Padding="15,8" Margin="0,0,0,12">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    
                                    <TextBlock Grid.Row="0" Grid.Column="0" Text="フォント" Foreground="#BBB" VerticalAlignment="Center" Margin="0,0,15,6"/>
                                    <ComboBox Grid.Row="0" Grid.Column="1" Name="CmbFont" Height="24" VerticalContentAlignment="Center" Margin="0,0,0,6" SelectionChanged="Interact_Changed"/>

                                    <TextBlock Grid.Row="1" Grid.Column="0" Text="サイズ" Foreground="#BBB" VerticalAlignment="Center" Margin="0,0,15,4"/>
                                    
                                    <Grid Grid.Row="1" Grid.Column="1" Margin="0,0,0,4">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="40"/>
                                            <ColumnDefinition Width="10"/>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="40"/>
                                            <ColumnDefinition Width="10"/>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="40"/>
                                            
                                            <ColumnDefinition Width="10"/>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="40"/>
                                            </Grid.ColumnDefinitions>
                                        
                                        <TextBlock Grid.Column="0" Text="本体" Foreground="#BBB" FontSize="11" VerticalAlignment="Center" Margin="0,0,5,0"/>
                                        <TextBox Grid.Column="1" Name="TxtFontSize" Background="#1E1E1E" Foreground="White" BorderBrush="#555" Height="24" VerticalContentAlignment="Center" TextChanged="Interact_Changed"/>
                                        
                                        <TextBlock Grid.Column="3" Text="リスト見出し" Foreground="#BBB" FontSize="11" VerticalAlignment="Center" Margin="0,0,5,0"/>
                                        <TextBox Grid.Column="4" Name="TxtHeaderFontSize" Background="#1E1E1E" Foreground="White" BorderBrush="#555" Height="24" VerticalContentAlignment="Center" TextChanged="Interact_Changed"/>

                                        <TextBlock Grid.Column="6" Text="フッター" Foreground="#BBB" FontSize="11" VerticalAlignment="Center" Margin="0,0,5,0"/>
                                        <TextBox Grid.Column="7" Name="TxtFooterFontSize" Background="#1E1E1E" Foreground="White" BorderBrush="#555" Height="24" VerticalContentAlignment="Center" TextChanged="Interact_Changed"/>

                                        <TextBlock Grid.Column="9" Text="ツールチップ" Foreground="#BBB" FontSize="11" VerticalAlignment="Center" Margin="0,0,5,0"/>
                                        <TextBox Grid.Column="10" Name="TxtToolTipFontSize" Background="#1E1E1E" Foreground="White" BorderBrush="#555" Height="24" VerticalContentAlignment="Center" TextChanged="Interact_Changed"/>
                                        </Grid>

                                    <TextBlock Grid.Row="2" Grid.Column="0" Text="行間 (上下)" Foreground="#BBB" VerticalAlignment="Center" Margin="0,0,15,4"/>
                                    <Grid Grid.Row="2" Grid.Column="1" Margin="0,0,0,4">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="30"/>
                                        </Grid.ColumnDefinitions>
                                        <Slider Grid.Column="0" Name="SldItemPadding" Minimum="-10.0" Maximum="20.0" TickFrequency="0.1" IsSnapToTickEnabled="True" VerticalAlignment="Center" ValueChanged="SldItemPadding_ValueChanged"/>
                                        <TextBlock Grid.Column="1" Text="{Binding ElementName=SldItemPadding, Path=Value, StringFormat=N1}" Foreground="#BBB" HorizontalAlignment="Right" VerticalAlignment="Center"/>
                                    </Grid>

                                    <TextBlock Grid.Row="3" Grid.Column="0" Text="リスト余白" Foreground="#BBB" VerticalAlignment="Top" Margin="0,4,15,0"/>
                                    <Grid Grid.Row="3" Grid.Column="1" Margin="0,4,0,0">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="30"/>
                                            <ColumnDefinition Width="10"/>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="30"/>
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                        </Grid.RowDefinitions>

                                        <TextBlock Grid.Row="0" Grid.Column="0" Text="左" Foreground="#BBB" FontSize="11" VerticalAlignment="Center" Margin="0,0,5,0"/>
                                        <Slider Grid.Row="0" Grid.Column="1" Name="SldMarginLeft" Minimum="0" Maximum="100" TickFrequency="1" IsSnapToTickEnabled="True" VerticalAlignment="Center" ValueChanged="SldMargin_ValueChanged"/>
                                        <TextBlock Grid.Row="0" Grid.Column="2" Text="{Binding ElementName=SldMarginLeft, Path=Value, StringFormat=N0}" Foreground="#BBB" HorizontalAlignment="Right" VerticalAlignment="Center"/>
                                        
                                        <TextBlock Grid.Row="0" Grid.Column="4" Text="右" Foreground="#BBB" FontSize="11" VerticalAlignment="Center" Margin="0,0,5,0"/>
                                        <Slider Grid.Row="0" Grid.Column="5" Name="SldMarginRight" Minimum="0" Maximum="100" TickFrequency="1" IsSnapToTickEnabled="True" VerticalAlignment="Center" ValueChanged="SldMargin_ValueChanged"/>
                                        <TextBlock Grid.Row="0" Grid.Column="6" Text="{Binding ElementName=SldMarginRight, Path=Value, StringFormat=N0}" Foreground="#BBB" HorizontalAlignment="Right" VerticalAlignment="Center"/>

                                        <TextBlock Grid.Row="1" Grid.Column="0" Text="上" Foreground="#BBB" FontSize="11" VerticalAlignment="Center" Margin="0,0,5,0"/>
                                        <Slider Grid.Row="1" Grid.Column="1" Name="SldMarginTop" Minimum="0" Maximum="100" TickFrequency="1" IsSnapToTickEnabled="True" VerticalAlignment="Center" ValueChanged="SldMargin_ValueChanged"/>
                                        <TextBlock Grid.Row="1" Grid.Column="2" Text="{Binding ElementName=SldMarginTop, Path=Value, StringFormat=N0}" Foreground="#BBB" HorizontalAlignment="Right" VerticalAlignment="Center"/>

                                        <TextBlock Grid.Row="1" Grid.Column="4" Text="下" Foreground="#BBB" FontSize="11" VerticalAlignment="Center" Margin="0,0,5,0"/>
                                        <Slider Grid.Row="1" Grid.Column="5" Name="SldMarginBottom" Minimum="0" Maximum="100" TickFrequency="1" IsSnapToTickEnabled="True" VerticalAlignment="Center" ValueChanged="SldMargin_ValueChanged"/>
                                        <TextBlock Grid.Row="1" Grid.Column="6" Text="{Binding ElementName=SldMarginBottom, Path=Value, StringFormat=N0}" Foreground="#BBB" HorizontalAlignment="Right" VerticalAlignment="Center"/>
                                    </Grid>
                                </Grid>
                            </Border>

                            <TextBlock Text="配色カスタマイズ" Foreground="#88CCFF" Margin="0,0,0,4"/>
                            <Border Background="#333337" CornerRadius="3" Padding="15,8" Margin="0,0,0,12">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="65"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="30"/>
                                        <ColumnDefinition Width="15"/>
                                        <ColumnDefinition Width="65"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="30"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="28"/>
                                        <RowDefinition Height="28"/>
                                        <RowDefinition Height="28"/>
                                        <RowDefinition Height="28"/>
                                        <RowDefinition Height="28"/>
                                        <RowDefinition Height="28"/>
                                        </Grid.RowDefinitions>

                                    <TextBlock Grid.Row="0" Grid.Column="0" Text="背景色" Foreground="#BBB" VerticalAlignment="Center"/>
                                    <TextBox Grid.Row="0" Grid.Column="1" Name="TxtBgColor" Background="#1E1E1E" Foreground="White" BorderBrush="#555" Height="22" VerticalContentAlignment="Center" TextChanged="Interact_Changed"/>
                                    <Button Grid.Row="0" Grid.Column="2" Content="🎨" Click="BtnPickBg_Click" Background="#444" Foreground="White" BorderThickness="0" Height="22" Margin="6,0,0,0"/>

                                    <TextBlock Grid.Row="1" Grid.Column="0" Text="スクロール" Foreground="#BBB" VerticalAlignment="Center" FontSize="11"/>
                                    <TextBox Grid.Row="1" Grid.Column="1" Name="TxtScrollBarColor" Background="#1E1E1E" Foreground="White" BorderBrush="#555" Height="22" VerticalContentAlignment="Center" TextChanged="Interact_Changed"/>
                                    <Button Grid.Row="1" Grid.Column="2" Content="🎨" Click="BtnPickScrollBar_Click" Background="#444" Foreground="White" BorderThickness="0" Height="22" Margin="6,0,0,0"/>

                                    <TextBlock Grid.Row="2" Grid.Column="0" Text="カラム枠線" Foreground="#BBB" VerticalAlignment="Center" FontSize="11"/>
                                    <TextBox Grid.Row="2" Grid.Column="1" Name="TxtColumnBorderColor" Background="#1E1E1E" Foreground="White" BorderBrush="#555" Height="22" VerticalContentAlignment="Center" TextChanged="Interact_Changed"/>
                                    <Button Grid.Row="2" Grid.Column="2" Content="🎨" Click="BtnPickColumnBorder_Click" Background="#444" Foreground="White" BorderThickness="0" Height="22" Margin="6,0,0,0"/>

                                    <TextBlock Grid.Row="3" Grid.Column="0" Text="フッター" Foreground="#BBB" VerticalAlignment="Center"/>
                                    <TextBox Grid.Row="3" Grid.Column="1" Name="TxtFooterColor" Background="#1E1E1E" Foreground="White" BorderBrush="#555" Height="22" VerticalContentAlignment="Center" TextChanged="Interact_Changed"/>
                                    <Button Grid.Row="3" Grid.Column="2" Content="🎨" Click="BtnPickFooter_Click" Background="#444" Foreground="White" BorderThickness="0" Height="22" Margin="6,0,0,0"/>

                                    <TextBlock Grid.Row="4" Grid.Column="0" Text="進捗バー" Foreground="#BBB" VerticalAlignment="Center"/>
                                    <TextBox Grid.Row="4" Grid.Column="1" Name="TxtProgressBarColor" Background="#1E1E1E" Foreground="White" BorderBrush="#555" Height="22" VerticalContentAlignment="Center" TextChanged="Interact_Changed"/>
                                    <Button Grid.Row="4" Grid.Column="2" Content="🎨" Click="BtnPickProgressBar_Click" Background="#444" Foreground="White" BorderThickness="0" Height="22" Margin="6,0,0,0"/>

                                    <TextBlock Grid.Row="5" Grid.Column="0" Text="エラー" Foreground="#BBB" VerticalAlignment="Center"/>
                                    <TextBox Grid.Row="5" Grid.Column="1" Name="TxtErrorColor" Background="#1E1E1E" Foreground="White" BorderBrush="#555" Height="22" VerticalContentAlignment="Center" TextChanged="Interact_Changed"/>
                                    <Button Grid.Row="5" Grid.Column="2" Content="🎨" Click="BtnPickError_Click" Background="#444" Foreground="White" BorderThickness="0" Height="22" Margin="6,0,0,0"/>

                                    <TextBlock Grid.Row="0" Grid.Column="4" Text="通常文字" Foreground="#BBB" VerticalAlignment="Center"/>
                                    <TextBox Grid.Row="0" Grid.Column="5" Name="TxtFgColor" Background="#1E1E1E" Foreground="White" BorderBrush="#555" Height="22" VerticalContentAlignment="Center" TextChanged="Interact_Changed"/>
                                    <Button Grid.Row="0" Grid.Column="6" Content="🎨" Click="BtnPickFg_Click" Background="#444" Foreground="White" BorderThickness="0" Height="22" Margin="6,0,0,0"/>

                                    <TextBlock Grid.Row="1" Grid.Column="4" Text="録画中" Foreground="#BBB" VerticalAlignment="Center"/>
                                    <TextBox Grid.Row="1" Grid.Column="5" Name="TxtRecColor" Background="#1E1E1E" Foreground="White" BorderBrush="#555" Height="22" VerticalContentAlignment="Center" TextChanged="Interact_Changed"/>
                                    <Button Grid.Row="1" Grid.Column="6" Content="🎨" Click="BtnPickRec_Click" Background="#444" Foreground="White" BorderThickness="0" Height="22" Margin="6,0,0,0"/>

                                    <TextBlock Grid.Row="2" Grid.Column="4" Text="無効" Foreground="#BBB" VerticalAlignment="Center"/>
                                    <TextBox Grid.Row="2" Grid.Column="5" Name="TxtDisabledColor" Background="#1E1E1E" Foreground="White" BorderBrush="#555" Height="22" VerticalContentAlignment="Center" TextChanged="Interact_Changed"/>
                                    <Button Grid.Row="2" Grid.Column="6" Content="🎨" Click="BtnPickDisabled_Click" Background="#444" Foreground="White" BorderThickness="0" Height="22" Margin="6,0,0,0"/>
                                    
                                    <TextBlock Grid.Row="3" Grid.Column="4" Text="Tチップ文字" Foreground="#BBB" VerticalAlignment="Center" FontSize="11"/>
                                    <TextBox Grid.Row="3" Grid.Column="5" Name="TxtToolTipFgColor" Background="#1E1E1E" Foreground="White" BorderBrush="#555" Height="22" VerticalContentAlignment="Center" TextChanged="Interact_Changed"/>
                                    <Button Grid.Row="3" Grid.Column="6" Content="🎨" Click="BtnPickToolTipFg_Click" Background="#444" Foreground="White" BorderThickness="0" Height="22" Margin="6,0,0,0"/>

                                    <TextBlock Grid.Row="4" Grid.Column="4" Text="Tチップ背景" Foreground="#BBB" VerticalAlignment="Center" FontSize="11"/>
                                    <TextBox Grid.Row="4" Grid.Column="5" Name="TxtToolTipBgColor" Background="#1E1E1E" Foreground="White" BorderBrush="#555" Height="22" VerticalContentAlignment="Center" TextChanged="Interact_Changed"/>
                                    <Button Grid.Row="4" Grid.Column="6" Content="🎨" Click="BtnPickToolTipBg_Click" Background="#444" Foreground="White" BorderThickness="0" Height="22" Margin="6,0,0,0"/>

                                    <TextBlock Grid.Row="5" Grid.Column="4" Text="Tチップ枠線" Foreground="#BBB" VerticalAlignment="Center" FontSize="11"/>
                                    <TextBox Grid.Row="5" Grid.Column="5" Name="TxtToolTipBorderColor" Background="#1E1E1E" Foreground="White" BorderBrush="#555" Height="22" VerticalContentAlignment="Center" TextChanged="Interact_Changed"/>
                                    <Button Grid.Row="5" Grid.Column="6" Content="🎨" Click="BtnPickToolTipBorder_Click" Background="#444" Foreground="White" BorderThickness="0" Height="22" Margin="6,0,0,0"/>
                                    </Grid>
                            </Border>
                        </StackPanel>
                    </ScrollViewer>
                </TabItem>

                <TabItem Header="カラム表示">
                    <ScrollViewer VerticalScrollBarVisibility="Auto">
                        <StackPanel Margin="0,10,10,0">
                            <TextBlock Text="全体表示設定" Foreground="#88CCFF" Margin="0,0,0,4"/>
                            <Border Background="#333337" CornerRadius="3" Padding="15,8" Margin="0,0,0,12">
                                <StackPanel Orientation="Horizontal">
                                    <CheckBox Name="ChkShowHeader" Content="ヘッダー" Foreground="White" Margin="0,0,20,0" Click="Interact_Changed"/>
                                    <CheckBox Name="ChkShowListHeader" Content="リスト見出し" Foreground="White" Margin="0,0,20,0" Click="Interact_Changed"/>
                                    <CheckBox Name="ChkShowFooter" Content="フッター" Foreground="White" Click="Interact_Changed"/>
                                </StackPanel>
                            </Border>

                            <TextBlock Text="日時表示で省略する" Foreground="#88CCFF" Margin="0,4,0,4"/>
                            <Border Background="#333337" CornerRadius="3" Padding="15,8" Margin="0,0,0,12">
                                <StackPanel Orientation="Horizontal">
                                    <CheckBox Name="ChkOmitYear" Content="年" Foreground="White" Margin="0,0,15,0" Click="DataSetting_Changed"/>
                                    <CheckBox Name="ChkOmitMonth" Content="月" Foreground="White" Margin="0,0,15,0" Click="DataSetting_Changed"/>
                                    <CheckBox Name="ChkOmitEndTime" Content="終了時刻" Foreground="White" Margin="0,0,15,0" Click="DataSetting_Changed"/>
                                    <CheckBox Name="ChkOmitProgress" Content="進捗バー" Foreground="White" Click="DataSetting_Changed"/>
                                </StackPanel>
                            </Border>

                            <TextBlock Text="表示するカラム (EDCB準拠)" Foreground="#88CCFF" Margin="0,0,0,4"/>
                            <Border Background="#333337" CornerRadius="3" Padding="15,8">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    
                                    <StackPanel Grid.Column="0">
                                        <CheckBox Name="ChkColStatus" Content="状態" Foreground="White" Margin="0,3" Click="Interact_Changed"/>
                                        <CheckBox Name="ChkColDateTime" Content="日時" Foreground="White" Margin="0,3" Click="Interact_Changed"/>
                                        <CheckBox Name="ChkColDuration" Content="長さ" Foreground="White" Margin="0,3" Click="Interact_Changed"/>
                                        <CheckBox Name="ChkColNetwork" Content="ネットワーク" Foreground="White" Margin="0,3" Click="Interact_Changed"/>
                                        <CheckBox Name="ChkColServiceName" Content="サービス名" Foreground="White" Margin="0,3" Click="Interact_Changed"/>
                                        <CheckBox Name="ChkColTitle" Content="番組名" Foreground="White" Margin="0,3" Click="Interact_Changed"/>
                                        <CheckBox Name="ChkColDesc" Content="番組内容" Foreground="White" Margin="0,3" Click="Interact_Changed"/>
                                        <CheckBox Name="ChkColGenre" Content="ジャンル" Foreground="White" Margin="0,3" Click="Interact_Changed"/>
                                        <CheckBox Name="ChkColExtraInfo" Content="付属情報" Foreground="White" Margin="0,3" Click="Interact_Changed"/>
                                        <CheckBox Name="ChkColEnabled" Content="有効/無効" Foreground="White" Margin="0,3" Click="Interact_Changed"/>
                                    </StackPanel>
                                    
                                    <StackPanel Grid.Column="1">
                                        <CheckBox Name="ChkColProgramType" Content="プログラム予約" Foreground="White" Margin="0,3" Click="Interact_Changed"/>
                                        <CheckBox Name="ChkColComment" Content="予約状況" Foreground="White" Margin="0,3" Click="Interact_Changed"/>
                                        <CheckBox Name="ChkColError" Content="エラー状況" Foreground="White" Margin="0,3" Click="Interact_Changed"/>
                                        <CheckBox Name="ChkColRecFileName" Content="予定ファイル名" Foreground="White" Margin="0,3" Click="Interact_Changed"/>
                                        <CheckBox Name="ChkColRecFileNameList" Content="予定ファイル名リスト" Foreground="White" Margin="0,3" Click="Interact_Changed"/>
                                        <CheckBox Name="ChkColTuner" Content="使用予定チューナー" Foreground="White" Margin="0,3" Click="Interact_Changed"/>
                                        <CheckBox Name="ChkColEstSize" Content="予想サイズ" Foreground="White" Margin="0,3" Click="Interact_Changed"/>
                                        <CheckBox Name="ChkColPreset" Content="プリセット" Foreground="White" Margin="0,3" Click="Interact_Changed"/>
                                        <CheckBox Name="ChkColRecMode" Content="録画モード" Foreground="White" Margin="0,3" Click="Interact_Changed"/>
                                        <CheckBox Name="ChkColPriority" Content="優先度" Foreground="White" Margin="0,3" Click="Interact_Changed"/>
                                    </StackPanel>

                                    <StackPanel Grid.Column="2">
                                        <CheckBox Name="ChkColTuijyuu" Content="追従" Foreground="White" Margin="0,3" Click="Interact_Changed"/>
                                        <CheckBox Name="ChkColPittari" Content="ぴったり(?)" Foreground="White" Margin="0,3" Click="Interact_Changed"/>
                                        <CheckBox Name="ChkColTunerForce" Content="チューナー強制" Foreground="White" Margin="0,3" Click="Interact_Changed"/>
                                        <CheckBox Name="ChkColRecEndMode" Content="録画後動作" Foreground="White" Margin="0,3" Click="Interact_Changed"/>
                                        <CheckBox Name="ChkColReboot" Content="復帰後再起動" Foreground="White" Margin="0,3" Click="Interact_Changed"/>
                                        <CheckBox Name="ChkColBat" Content="録画後実行bat" Foreground="White" Margin="0,3" Click="Interact_Changed"/>
                                        <CheckBox Name="ChkColRecTag" Content="録画タグ" Foreground="White" Margin="0,3" Click="Interact_Changed"/>
                                        <CheckBox Name="ChkColRecFolder" Content="録画フォルダ" Foreground="White" Margin="0,3" Click="Interact_Changed"/>
                                        <CheckBox Name="ChkColStartMargin" Content="開始タイミング" Foreground="White" Margin="0,3" Click="Interact_Changed"/>
                                        <CheckBox Name="ChkColEndMargin" Content="終了タイミング" Foreground="White" Margin="0,3" Click="Interact_Changed"/>
                                        <CheckBox Name="ChkColID" Content="ID" Foreground="White" Margin="0,3" Click="Interact_Changed"/>
                                    </StackPanel>
                                </Grid>
                            </Border>
                        </StackPanel>
                    </ScrollViewer>
                </TabItem>

             </TabControl>

            <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,10,0,0">
                <Button Content="保存" Width="100" Height="30" Margin="0,0,10,0" Background="#007ACC" Foreground="White" BorderThickness="0" Cursor="Hand" Click="BtnSave_Click"/>
                <Button Content="キャンセル" Width="100" Height="30" Background="#3E3E42" Foreground="White" BorderThickness="0" Cursor="Hand" Click="BtnCancel_Click"/>
            </StackPanel>
        </Grid>
    </Border>
</Window>